name: Scheduled Crowdin Sync

on:
    schedule:
        - cron: '0 */12 * * *' # Sync every 12 hours - https://crontab.guru/#0_*/12_*_*_*
    workflow_dispatch: # For manually running the action

jobs:
  synchronize-with-crowdin:
    runs-on: ubuntu-latest

    permissions:
        contents: write

    steps:
          - name: Checkout 
            uses: actions/checkout@v3

          - name: Crowdin Action
            uses: crowdin/github-action@v1
            with:
                upload_sources: false
                upload_translations: false
                download_translations: true
                skip_untranslated_strings: true
                localization_branch_name: i18n
                create_pull_request: true
                pull_request_title: 'New Translations'
                source: locale/en.json
                translation: locale/%two_letters_code%.json
                project_id: ${{ secrets.CROWDIN_PROJECT_ID }}
                token: ${{ secrets.CROWDIN_PERSONAL_TOKEN }}
                # pull_request_assignees: 'StardustD2'
            env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}